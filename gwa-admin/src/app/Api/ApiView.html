<div *ngIf="object">
  <form #apiForm="ngForm" class="form-horizontal" role="form">
    <md-card> <md-card-content>
    <div fxLayout="row" fxLayout.xs="column" fxLayout.sm="column" fxLayoutGap="10px"
      fxLayoutGap.sm="2px" fxLayoutGap.xs="2px">
      <md-input-container fxFlex> <input mdInput placeholder="Name" name="name"
        [(ngModel)]="object.name" required="true" pattern="[a-zA-Z][a-zA-Z0-9_\-]*" />
      </md-input-container>
      <md-input-container fxFlex> <input mdInput placeholder="Created At"
        value="{{object.created_at | date:'yyyy-MM-dd HH:mm:ss'}}" disabled /> </md-input-container>
    </div>
    <div fxLayout="row" fxLayout.xs="column" fxLayout.sm="column" fxLayoutAlign="none"
      fxLayoutGap="10px" fxLayoutGap.sm="2px" fxLayoutGap.xs="2px">
      <md-input-container fxFlex> <input mdInput placeholder="Hosts"
        name="hosts" [(ngModel)]="object.hosts" /> </md-input-container>
      <md-input-container fxFlex> <input mdInput placeholder="Paths"
        name="uris" type="text" [(ngModel)]="object.uris" pattern="/.+" /> </md-input-container>
      <md-input-container fxFlex> <input mdInput placeholder="Upstream URL"
        name="upstream_url" type="url" [(ngModel)]="object.upstream_url" required="true"
        pattern="http(s)?://.+" /> </md-input-container>
    </div>
    <md-divider class="mat-divider"></md-divider>
    <div *ngIf="endpoint" fxLayout="row" fxLayout.xs="column" fxLayout.sm="column"
      fxLayoutAlign="none" fxLayoutGap="10px" fxLayoutGap.sm="2px" fxLayoutGap.xs="2px">
      <div>
        <label class="margin-top-1em">Owner Usernames:</label>
        <button (click)="addApiOwner()" md-icon-button style="color: green">
          <md-icon fontSet="fa" fontIcon="fa-plus-circle" alt="Add" aria-label="Add"></md-icon>
        </button>
      </div>
      <ng-template ngFor let-i="index" let-owner [ngForOf]="endpoint.config.api_owners"
        [ngForTrackBy]="trackByIndex"> <md-input-container fxFlex>
      <input mdInput name="api_owner_{{i}}" [(ngModel)]="endpoint.config.api_owners[i]"
        required="true" pattern="[a-z][a-z0-9_]*" />
      <button mdSuffix (click)="deleteApiOwner(i)" md-icon-button style="color: red">
        <md-icon fontSet="fa" fontIcon="fa-trash" alt="Delete" aria-label="Delete"></md-icon>
      </button>
      </md-input-container> </ng-template>
    </div>
    <md-divider class="mat-divider"></md-divider>
    <div *ngIf="keyAuth" fxLayout="row" fxLayout.xs="column" fxLayout.sm="column"
      fxLayoutAlign="none" fxLayoutGap="10px" fxLayoutGap.sm="2px" fxLayoutGap.xs="2px">
      <md-slide-toggle name="keyAuth_enabled" [(ngModel)]="keyAuth.enabled" color="primary"
        style="display: inline-block">Allow Developer Keys</md-slide-toggle>
      <md-slide-toggle name="keyAuth_hide_credentials" [(ngModel)]="keyAuth.config.hide_credentials"
        color="primary" style="display: inline-block" [disabled]="!keyAuth.enabled">Hide
      Credentials</md-slide-toggle>
      <md-input-container fxFlex> <input mdInput placeholder="Key Name"
        name="keyAuth_key_names" [(ngModel)]="keyAuth.config.key_names" required="true"
        [disabled]="!keyAuth.enabled" /> </md-input-container>
      <md-select fxFlex placeholder="Developer Key Group" name="developer_key_group"
        [(ngModel)]="endpoint.config.developer_key_group"
        [disabled]="!keyAuth.enabled || !acl.enabled || developerKeyGroupNames.length == 0">
      <md-option *ngFor="let value of developerKeyGroupNames" [value]="value">{{value}}</md-option>
      </md-select>
    </div>
    <md-divider class="mat-divider"></md-divider>
    <div *ngIf="acl" fxLayout="row" fxLayout.xs="column" fxLayout.sm="column" fxLayoutAlign="none"
      fxLayoutGap="10px" fxLayoutGap.sm="2px" fxLayoutGap.xs="2px">
      <md-slide-toggle name="acl_enabled" [(ngModel)]="acl.enabled" color="primary"
        style="display: inline-block">Groups Enabled</md-slide-toggle>
      <div>
        <label class="margin-top-1em">Group Names:</label>
        <button (click)="addGroupName()" md-icon-button style="color: green"
          [disabled]="!acl.enabled">
          <md-icon fontSet="fa" fontIcon="fa-plus-circle" alt="Add" aria-label="Add"></md-icon>
        </button>
      </div>
      <ng-template ngFor let-i="index" let-groupName [ngForOf]="acl.config.whitelist"
        [ngForTrackBy]="trackByIndex"> <md-input-container fxFlex>
      <input mdInput name="groupName_{{i}}" [(ngModel)]="acl.config.whitelist[i]" required="true"
        [disabled]="!acl.enabled" pattern="[a-z][a-z0-9_]*" />
      <button mdSuffix (click)="deleteGroupName(i)" md-icon-button style="color: red"
        [disabled]="!acl.enabled">
        <md-icon fontSet="fa" fontIcon="fa-trash" alt="Delete" aria-label="Delete"></md-icon>
      </button>
      </md-input-container> </ng-template>
    </div>
    <md-divider class="mat-divider"></md-divider>
    <div fxLayout="row" fxLayout.xs="column" fxLayout.sm="column" fxLayoutAlign="none center"
      fxLayoutAlign.sm="" fxLayoutAlign.xs="" fxLayoutGap="10px" fxLayoutGap.sm="2px"
      fxLayoutGap.xs="2px">
      <md-slide-toggle name="preserve_host" [(ngModel)]="object.preserve_host" color="primary"
        style="display: inline-block">Preserve Host</md-slide-toggle>
      <md-slide-toggle name="strip_uri" [(ngModel)]="object.strip_uri" color="primary"
        style="display: inline-block">Strip URI</md-slide-toggle>
      <label>Methods:</label>
      <md-slide-toggle *ngFor="let methodFlag of object.method_flags" [checked]="methodFlag.enabled"
        (change)="methodFlag.enabled = $event.checked" color="primary" style="display: inline-block">{{methodFlag.name}}</md-slide-toggle>
    </div>
    <div fxLayout="row" fxLayout.xs="column" fxLayout.sm="column" fxLayoutAlign="none center"
      fxLayoutAlign.sm="" fxLayoutAlign.xs="" fxLayoutGap="10px" fxLayoutGap.sm="2px"
      fxLayoutGap.xs="2px">
      <md-slide-toggle name="https_only" [(ngModel)]="object.https_only" color="primary"
        style="display: inline-block">Https Only</md-slide-toggle>
      <md-slide-toggle name="http_if_terminated" [(ngModel)]="object.http_if_terminated"
        color="primary" style="display: inline-block">Http if
      Terminated</md-slide-toggle>
      <md-input-container fxFlex> <input mdInput placeholder="Retries"
        name="retries" type="number" min="0" max="32767" [(ngModel)]="object.retries" />
      </md-input-container>
      <md-input-container fxFlex> <input mdInput placeholder="Connect Timeout"
        name="upstream_connect_timeout" type="number" min="0"
        [(ngModel)]="object.upstream_connect_timeout" /> </md-input-container>
      <md-input-container fxFlex> <input mdInput placeholder="Send Timeout"
        name="upstream_send_timeout" type="number" min="0"
        [(ngModel)]="object.upstream_send_timeout" /> </md-input-container>
      <md-input-container fxFlex> <input mdInput placeholder="Read Timeout"
        name="upstream_read_timeout" type="number" min="0"
        [(ngModel)]="object.upstream_read_timeout" /> </md-input-container>
    </div>
    </md-card-content> <md-card-actions>
    <button (click)="routeList()" md-button>Close</button>
    <button (click)="save(false)" md-raised-button color="accent"
      [disabled]="!apiForm.form.valid || !formValid()">Save</button>
    <button (click)="save(true)" md-raised-button color="primary"
      [disabled]="!apiForm.form.valid || !formValid()">Save &amp; Close</button>
    </md-card-actions> </md-card>
  </form>
</div>