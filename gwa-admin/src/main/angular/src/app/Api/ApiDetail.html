<md-tab-group *ngIf="object" [selectedIndex]=[tabIndex]>
  <md-tab>
    <template md-tab-label>
      <span *ngIf="object.id" class="active">Api: {{object.name}}</span>
      <span *ngIf="!object.id" class="active">Add API</span>
    </template>

    <form #apiForm="ngForm" class="form-horizontal" role="form">
      <md-card>
        <md-card-content>
          <div class="row">
            <div class="col-sm-6">
              <md-input-container class="full-width">
                <input
                  mdInput
                  placeholder="Name" 
                  name="name"
                  [(ngModel)]="object.name"
                  required="true"
                  pattern="[a-zA-Z][a-zA-Z0-9_\-]*"
                />
              </md-input-container>
            </div>
            <div class="col-sm-6" *ngIf="object.created_at">
              <md-input-container class="full-width">
                <input
                  mdInput
                  placeholder="Created At"
                  value="{{object.created_at | date:'yyyy-MM-dd HH:mm:ss'}}"
                  disabled
                />
              </md-input-container>
            </div>
          </div>
          <div class="row" *ngIf="oldVersion">
            <div class="col-sm-6">
              <md-input-container class="full-width">
                <input
                  mdInput
                  placeholder="Request Host" 
                  name="request_host"
                  [(ngModel)]="object.request_host"
                />
              </md-input-container>
            </div>
            <div class="col-sm-6">
              <md-input-container class="full-width">
                <input
                  mdInput
                  placeholder="Request Path" 
                  name="request_path"
                  [(ngModel)]="object.request_path"
                />
              </md-input-container>
            </div>
          </div>
          <div class="row" *ngIf="!oldVersion">
            <div class="col-md-12">
              <md-input-container class="full-width">
                <input
                  mdInput
                  placeholder="Hosts" 
                  name="hosts"
                  [(ngModel)]="object.hosts"
                />
              </md-input-container>
            </div>
          </div>
          <div class="row" *ngIf="!oldVersion">
            <div class="col-md-12">
              <md-input-container class="full-width">
                <input
                  mdInput
                  placeholder="URIs" 
                  name="uris"
                  type="url"
                  [(ngModel)]="object.uris"
                />
              </md-input-container>
            </div>
          </div>
          <div class="containerX">
            <div class="container=" *ngIf="!oldVersion">
              <span fxFlex="1 1 110px">
                <md-slide-toggle
                  name="https_only"
                  [(ngModel)]="object.https_only"
                  color="primary"
                  style="display: inline-block"
                >Https Only</md-slide-toggle>
              </span>
              <span fxFlex="1 1 160px">
                <md-slide-toggle
                  name="http_if_terminated"
                  [(ngModel)]="object.http_if_terminated"
                  color="primary"
                  style="display: inline-block"
                >Http if Terminated</md-slide-toggle>
              </span>
              <span fxFlex="1 1 65px"><label>Methods:</label></span>
              <span fxFlex="1 1 100px" *ngFor="let methodFlag of object.method_flags">
                <md-slide-toggle
                  [checked]="methodFlag.enabled"
                  (change)="methodFlag.enabled = $event.checked"
                  color="primary"
                  style="display: inline-block"
                >{{methodFlag.name}}</md-slide-toggle>
              </span>
            </div>
          </div>

          <h2>Upstream Service</h2>

          <md-input-container class="full-width">
            <input
              mdInput
              placeholder="Upstream URL" 
              name="upstream_url"
              type="url"
              [(ngModel)]="object.upstream_url"
            />
          </md-input-container>
          <div class="row">
            <div class="col-md-2">
              <md-slide-toggle
                name="preserve_host"
                [(ngModel)]="object.preserve_host"
                color="primary"
              >Preserve Host</md-slide-toggle>
            </div>
            <div class="col-md-2">
              <md-slide-toggle
                *ngIf="oldVersion"
                name="strip_request_path"
                [(ngModel)]="object.strip_request_path"
                color="primary"
              >Strip URI</md-slide-toggle>
              <md-slide-toggle 
                *ngIf="!oldVersion"
                name="strip_uri"
                [(ngModel)]="object.strip_uri"
                color="primary"
              >Strip URI</md-slide-toggle>
            </div>
            <div class="col-md-2" *ngIf="!oldVersion">
              <md-input-container class="full-width">
                <input
                  mdInput
                  placeholder="Retries" 
                  name="retries"
                  type="number"
                  min="0"
                  max="32767"
                  [(ngModel)]="object.retries"
                />
              </md-input-container>
            </div>
            <div class="col-md-2">
              <md-input-container class="full-width">
                <input
                  mdInput
                  placeholder="Connect Timeout" 
                  name="upstream_connect_timeout"
                  type="number"
                  min="0"
                  [(ngModel)]="object.upstream_connect_timeout"
                />
              </md-input-container>
            </div>
            <div class="col-md-2">
              <md-input-container class="full-width">
                <input
                  mdInput
                  placeholder="Send Timeout" 
                  name="upstream_send_timeout"
                  type="number"
                  min="0"
                  [(ngModel)]="object.upstream_send_timeout"
                />
              </md-input-container>
            </div>
            <div class="col-md-2">
              <md-input-container class="full-width">
                <input
                  mdInput
                  placeholder="Read Timeout" 
                  name="upstream_read_timeout"
                  type="number"
                  min="0"
                  [(ngModel)]="object.upstream_read_timeout"
                />
              </md-input-container>
            </div>
          </div>
        </md-card-content>

        <md-card-actions>
          <button (click)="goBack()" md-button>Cancel</button>
          <button (click)="save()" md-raised-button color="primary" [disabled]="!apiForm.form.valid">Save</button>
        </md-card-actions>
      </md-card>
    </form>
  </md-tab>

  <md-tab *ngIf="object.id" label="Plugins">
    <api-plugin-list [api]="object"></api-plugin-list>
  </md-tab>

</md-tab-group>