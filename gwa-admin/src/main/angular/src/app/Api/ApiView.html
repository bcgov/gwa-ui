<div *ngIf="object">
  <form #apiForm="ngForm" class="form-horizontal" role="form">
    <md-card>
      <md-card-content>
        <div fxLayout="row" fxLayout.xs="column" fxLayout.sm="column" fxFlex fxLayoutGap="10px" fxLayoutGap.sm="2px" fxLayoutGap.xs="2px">
          <md-input-container fxFlex>
            <input
              mdInput
              placeholder="Name" 
              name="name"
              [(ngModel)]="object.name"
              required="true"
              pattern="[a-zA-Z][a-zA-Z0-9_\-]*"
            />
          </md-input-container>
          <md-input-container fxFlex>
            <input
              mdInput
              placeholder="Created At"
              value="{{object.created_at | date:'yyyy-MM-dd HH:mm:ss'}}"
              disabled
            />
          </md-input-container>
        </div>
        <div fxLayout="row" fxLayout.xs="column" fxLayout.sm="column" fxFlex fxLayoutAlign="none" fxLayoutGap="10px" fxLayoutGap.sm="2px" fxLayoutGap.xs="2px">
          <md-input-container fxFlex>
            <input
              mdInput
              placeholder="Hosts" 
              name="hosts"
              [(ngModel)]="object.hosts"
            />
          </md-input-container>
          <md-input-container fxFlex>
            <input
              mdInput
              placeholder="Paths" 
              name="uris"
              type="text"
              [(ngModel)]="object.uris"
            />
          </md-input-container>
        </div>

        <md-input-container class="full-width">
          <input
            mdInput
            placeholder="Upstream URL" 
            name="upstream_url"
            type="url"
            [(ngModel)]="object.upstream_url"
          />
        </md-input-container>

        <div *ngIf="endpoint" fxLayout="row" fxLayout.xs="column" fxLayout.sm="column" fxFlex fxLayoutAlign="none" fxLayoutGap="10px" fxLayoutGap.sm="2px" fxLayoutGap.xs="2px">
          <label class="margin-top-1em">Endpoint:</label>
          <md-input-container fxFlex *ngIf="endpoint.config.api_owners" fxLayout="column" fxLayoutGap="2px">
            <input
              *ngFor="let owner of endpoint.config.api_owners"
              mdInput
              placeholder="Owner Usernames"
              value="{{owner}}"
            />
          </md-input-container>
          <md-slide-toggle
            name="allow_developer_keys"
            [(ngModel)]="object.allow_developer_keys"
            color="primary"
            style="display: inline-block"
          >Allow Developer Keys</md-slide-toggle>
        </div>

        <div fxLayout="row" fxLayout.xs="column" fxLayout.sm="column" fxFlex fxLayoutAlign="none" fxLayoutGap="10px" fxLayoutGap.sm="2px" fxLayoutGap.xs="2px">
          <md-slide-toggle
            name="https_only"
            [(ngModel)]="object.https_only"
            color="primary"
            style="display: inline-block"
          >Https Only</md-slide-toggle>
          <md-slide-toggle
            name="http_if_terminated"
            [(ngModel)]="object.http_if_terminated"
            color="primary"
            style="display: inline-block"
          >Http if Terminated</md-slide-toggle>
        </div>

        <div fxLayout="row" fxLayout.xs="column" fxLayout.sm="column" fxFlex fxLayoutAlign="none center" fxLayoutAlign.sm="" fxLayoutAlign.xs="" fxLayoutGap="10px" fxLayoutGap.sm="2px" fxLayoutGap.xs="2px">
          <label>Methods:</label>
          <md-slide-toggle
            *ngFor="let methodFlag of object.method_flags"
            [checked]="methodFlag.enabled"
            (change)="methodFlag.enabled = $event.checked"
            color="primary"
            style="display: inline-block"
          >{{methodFlag.name}}</md-slide-toggle>
        </div>
        
        <div fxLayout="row" fxLayout.xs="column" fxLayout.sm="column" fxFlex fxLayoutAlign="none center" fxLayoutAlign.sm="" fxLayoutAlign.xs="" fxLayoutGap="10px" fxLayoutGap.sm="2px" fxLayoutGap.xs="2px">
          <md-slide-toggle
            fxFlex
            name="preserve_host"
            [(ngModel)]="object.preserve_host"
            color="primary"
            style="display: inline-block"
          >Preserve Host</md-slide-toggle>
          <md-slide-toggle
            fxFlex
            name="strip_uri"
            [(ngModel)]="object.strip_uri"
            color="primary"
          style="display: inline-block"
          >Strip URI</md-slide-toggle>
          <md-input-container fxFlex>
            <input
              mdInput
              placeholder="Retries" 
              name="retries"
              type="number"
              min="0"
              max="32767"
              [(ngModel)]="object.retries"
            />
          </md-input-container>
          <md-input-container fxFlex>
            <input
              mdInput
              placeholder="Connect Timeout" 
              name="upstream_connect_timeout"
              type="number"
              min="0"
              [(ngModel)]="object.upstream_connect_timeout"
            />
          </md-input-container>
          <md-input-container fxFlex>
            <input
              mdInput
              placeholder="Send Timeout" 
              name="upstream_send_timeout"
              type="number"
              min="0"
              [(ngModel)]="object.upstream_send_timeout"
            />
          </md-input-container>
          <md-input-container fxFlex>
            <input
              mdInput
              placeholder="Read Timeout" 
              name="upstream_read_timeout"
              type="number"
              min="0"
              [(ngModel)]="object.upstream_read_timeout"
            />
          </md-input-container>
        </div>

      </md-card-content>

      <md-card-actions>
        <button (click)="routeList()" md-button>Close</button>
        <button (click)="save(false)" md-raised-button color="accent" [disabled]="!apiForm.form.valid">Save</button>
        <button (click)="save(true)" md-raised-button color="primary" [disabled]="!apiForm.form.valid">Save &amp; Close</button>
      </md-card-actions>
    </md-card>
  </form>
</div>