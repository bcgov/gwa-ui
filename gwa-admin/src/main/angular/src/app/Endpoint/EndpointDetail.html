<md-tab-group *ngIf="object" [selectedIndex]=[tabIndex]>
  <md-tab>
    <template md-tab-label>
      <span *ngIf="object.id" class="active">Endpoint: {{object.name}}</span>
      <span *ngIf="!object.id" class="active">Add Endpoint</span>
    </template>

    <form #endpointForm="ngForm" class="form-horizontal" role="form">
      <md-card>
        <md-card-content fxLayoutGap="2px">
          <div fxLayout="row" fxLayout.xs="column" fxLayout.sm="column" fxFlex fxLayoutGap="10px" fxLayoutGap.sm="2px" fxLayoutGap.xs="2px">
            <md-input-container fxFlex>
              <input
                mdInput
                placeholder="Name" 
                name="name"
                [(ngModel)]="object.name"
                required="true"
                pattern="[a-zA-Z][a-zA-Z0-9_\-]*"
              />
            </md-input-container>
            <md-input-container fxFlex *ngIf="object.created_by">
              <input
                mdInput
                placeholder="Created By"
                value="{{object.created_by}}"
                disabled
              />
            </md-input-container>
            <md-input-container fxFlex *ngIf="object.created_at">
              <input
                mdInput
                placeholder="Created At"
                value="{{object.created_at | date:'yyyy-MM-dd HH:mm:ss'}}"
                disabled
              />
            </md-input-container>
          </div>
          <div fxLayout="row" fxLayout.xs="column" fxLayout.sm="column" fxFlex fxLayoutGap="10px" fxLayoutGap.sm="2px" fxLayoutGap.xs="2px">
            <md-select
              fxFlex
              placeholder="URI Template"
              name="uri_template"
              [(ngModel)]="endPoint.uri_template"
              required="true"
            >
              <md-option *ngFor="let value of endPointUriTemplates" [value]="value">{{value}}</md-option>
            </md-select>
            <md-input-container fxFlex>
              <input
                mdInput
                placeholder="URI" 
                value="{{Endpoint.uri(endPoint)}}"
                disabled="true"
              />
            </md-input-container>
          </div>
          <div fxLayout="row" fxLayout.xs="column" fxLayout.sm="column" fxFlex fxLayoutAlign="none" fxLayoutGap="10px" fxLayoutGap.sm="2px" fxLayoutGap.xs="2px">
            <md-slide-toggle
              name="https_only"
              [(ngModel)]="object.https_only"
              color="primary"
              style="display: inline-block"
            >Https Only</md-slide-toggle>
            <md-slide-toggle
              name="http_if_terminated"
              [(ngModel)]="object.http_if_terminated"
              color="primary"
              style="display: inline-block"
            >Http if Terminated</md-slide-toggle>
          </div>
          <div fxLayout="row" fxLayout.xs="column" fxLayout.sm="column" fxFlex fxLayoutAlign="none center" fxLayoutAlign.sm="" fxLayoutAlign.xs="" fxLayoutGap="10px" fxLayoutGap.sm="2px" fxLayoutGap.xs="2px">
            <label>Methods:</label>
            <md-slide-toggle
              *ngFor="let methodFlag of object.method_flags"
              [checked]="methodFlag.enabled"
              (change)="methodFlag.enabled = $event.checked"
              color="primary"
              style="display: inline-block"
            >{{methodFlag.name}}</md-slide-toggle>
          </div>

          <fieldset fxLayoutGap="2px">
            <legend>Upstream Service</legend>
  
            <div fxLayout="row" fxLayout.xs="column" fxLayout.sm="column" fxFlex fxLayoutAlign=" end" fxLayoutGap="10px" fxLayoutGap.sm="2px" fxLayoutGap.xs="2px">
              <md-input-container class="full-width" fxFlex="50">
                <input
                  mdInput
                  placeholder="Upstream URL" 
                  name="upstream_url"
                  type="url"
                  [(ngModel)]="object.upstream_url"
                />
              </md-input-container>
              <md-input-container class="full-width" fxFlex="25">
                <input
                  mdInput
                  placeholder="Upstream Username" 
                  name="upstream_username"
                  type="text"
                  [(ngModel)]="endPoint.upstream_username"
                />
              </md-input-container>
              <md-input-container class="full-width" fxFlex="25">
                <input
                  mdInput
                  placeholder="Upstream Password" 
                  name="upstream_password"
                  type="password"
                  [(ngModel)]="endPoint.upstream_password"
                />
              </md-input-container>
            </div>
            <div fxLayout="row" fxLayout.xs="column" fxLayout.sm="column" fxFlex fxLayoutAlign="none center" fxLayoutAlign.sm="" fxLayoutAlign.xs="" fxLayoutGap="10px" fxLayoutGap.sm="2px" fxLayoutGap.xs="2px">
              <md-slide-toggle
                fxFlex
                name="preserve_host"
                [(ngModel)]="object.preserve_host"
                color="primary"
                style="display: inline-block"
              >Preserve Host</md-slide-toggle>
              <md-slide-toggle
                fxFlex
                name="strip_uri"
                [(ngModel)]="object.strip_uri"
                color="primary"
              style="display: inline-block"
              >Strip URI</md-slide-toggle>
              <md-input-container fxFlex>
                <input
                  mdInput
                  placeholder="Retries" 
                  name="retries"
                  type="number"
                  min="0"
                  max="32767"
                  [(ngModel)]="object.retries"
                />
              </md-input-container>
              <md-input-container fxFlex>
                <input
                  mdInput
                  placeholder="Connect Timeout" 
                  name="upstream_connect_timeout"
                  type="number"
                  min="0"
                  [(ngModel)]="object.upstream_connect_timeout"
                />
              </md-input-container>
              <md-input-container fxFlex>
                <input
                  mdInput
                  placeholder="Send Timeout" 
                  name="upstream_send_timeout"
                  type="number"
                  min="0"
                  [(ngModel)]="object.upstream_send_timeout"
                />
              </md-input-container>
              <md-input-container fxFlex>
                <input
                  mdInput
                  placeholder="Read Timeout" 
                  name="upstream_read_timeout"
                  type="number"
                  min="0"
                  [(ngModel)]="object.upstream_read_timeout"
                />
              </md-input-container>
            </div>
          </fieldset>
        </md-card-content>

        <md-card-actions>
          <button (click)="goBack()" md-button>Cancel</button>
          <button (click)="save()" md-raised-button color="primary" [disabled]="!endpointForm.form.valid">Save</button>
        </md-card-actions>
      </md-card>
    </form>
  </md-tab>

</md-tab-group>